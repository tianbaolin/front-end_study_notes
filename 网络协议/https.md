## HTTPS

### 1. HTTP 问题

* 数据窃听 - 明文传输
* 数据篡改 - 无完整性校验
* 身份伪装 - 无身份验证

### 2. HTTS解决的问题

* 数据窃听 - 通信加密
* 数据篡改 - 数字签名
* 身份伪装 - 数字证书

### 3. 通信加密

####3.1 对称加密算法AES

高级加密标准（英语：Advanced Encryption Standard，缩写：AES），在密码学中又称Rijndael加密法，是美国联邦政府采用的一种区块加密标准。这个标准用来替代原先的DES，已经被多方分析且广为全世界所使用。

#### 3.2 非对称加密RSA

RSA加密算法是一种非对称加密算法，在公开密钥加密和电子商业中被广泛使用。对极大整数做因数分解的难度决定了RSA算法的可靠性。换言之，对一极大整数做因数分解愈困难，RSA算法愈可靠。假如有人找到一种快速因数分解的算法的话，那么用RSA加密的信息的可靠性就会极度下降。但找到这样的算法的可能性是非常小的。今天只有短的RSA钥匙才可能被强力方式破解。到当前为止，世界上还没有任何可靠的攻击RSA算法的方式。只要其钥匙的长度足够长，用RSA加密的信息实际上是不能被破解的。

#### 3.3 HTTPS 加密方案

* 客户端生成随机数作为AES密钥

* 客户端RSA公钥加密 AES 密钥    服务端RSA 私钥解密 AES 密钥
* AES 密钥 加密和解密通信数据

### 4. 数字证书方案

#### 4.1 数字证书定义

CA中心为每个使用公开密钥的用户发放一个数字证书，数字证书的作用是证明证书中列出的用户合法拥有证书中列出的公开密钥。证书的内容包括：电子签证机关的信息、公钥用户信息、公钥、权威机构的签字和有效期等等。

#### 4.2 工作原理

* CA中心自己拥有CA私钥和CA公钥，用于RSA算法加解密
* CA中心用CA私钥加密服务器提供的RSA 公钥，形成数字签名（保证RSA公钥安全）
* 服务器获取数字证书后将包含数字签名的数字证书传输给客户端，RSA私钥服务器保存
* 客户端内置CA根证书，其中包含CA公钥。客户端用CA公钥解密证书数字签名，得到RSA公钥
* 客户端生成随机数作为AES密钥

- 客户端用RSA公钥加密 AES 密钥    服务端RSA 私钥解密 AES 密钥（保证AES密钥安全）
- AES 密钥 加密和解密通信数据，服务器客户端相互加解密

追踪溯源，AES密钥受RSA加密保护，RSA公钥受CA证书保护，CA证书的一对密钥分别在客户端和CA机构本地保存，不走互联网传播。其核心安全在于客户端一定要内置正确安全的CA根证书。其本质是在互联网上传输都不如线下传输来的安全。

#### 4.3 数字证书意义

* 服务器数字证书是客户端用来验证服务器身份
* 客户端证书是服务器用来验证客户端身份（极少使用，网银登陆需要插入U顿就是此类认证，需要双方校验身份。）

### 5. 数字签名方案

* 在http通信中，对传输数据进行hash计算，得到的信息摘要用RSA 公钥/私钥加密得到数字签名
* 接收方 用RSA 私钥/公钥解密得到信息摘要，再将接收到的数据hash后与解密得到的信息摘要对比，一致则信息完整，没有被篡改。



